{
  "inode": {
    "org": "",
    "id": "cmdb_x-eg2ndad9cj91",
    "schema_id": "cmdb_schema_x-1dwkbiz80orwl",
    "name": "可用区资源数量",
    "namespace": "",
    "descr": "auto-test",
    "ctime": 0,
    "mtime": 0,
    "creator": "",
    "last_editor": "",
    "archived": false,
    "lock": ""
  },
  "data": {
    "acquisition_plan": "0 0 * * *",
    "advancement": {
      "script": "function getData() {\n\t// var ctx = new WorkflowRuntimeContext()\n\tvar all_result = []\n\tvar jg = []\n\tvar all_jg_server = []\n\tvar zone_ids = []\n\tvar zone_name = []\n\tvar id = []\n\tvar zone_ql = {\n\t\t\"conditions\": [\n\t\t\t{\n\t\t\t\t\"field\": \".inode.schema_id\",\n\t\t\t\t\"op\": \"=\",\n\t\t\t\t\"value\": \"cmdb_schema_u_cloud_zone-0\"    //可用区模型  \n\n\t\t\t},\n\t\t],\n\t\t\"objects\": [\n\t\t\t\"$conditions\"\n\t\t],\n\t\t\"selects\": [\".inode.id\"]\n\t}   //拿到可用区模型下所有的可用区id\n\tvar zone_data = ctx.ecu.cmdb.queryObjects(zone_ql).objects\n\t//ctx.output(zone_data)\n\tzone_data.forEach(function (item) {\n\t\tzone_ids.push(item.inode.id)\n\t})\n\t//ctx.output(zone_ids)\n\n\tzone_ids.forEach(function (item_zone) {\n\t\t//console.log(item_zone)\n\t\tvar all_ql = {\n\t\t\t\"objects\": [\"$conditions\"],\n\t\t\t\"conditions\": [\n\t\t\t\t{\n\t\t\t\t\t\"field\": \".inode.schema_id\",\n\t\t\t\t\t\"op\": \"=-\",\n\t\t\t\t\t\"value\": [\n\t\t\t\t\t\t\"cmdb_schema_u_crf_server-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_domain-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_vpc-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_slb-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_redis-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_cloud_rds-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_mongodb-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_eip-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_certificate-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_ssh_key-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_oss_bucket-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_cdn_domain-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_es-0\",\n\t\t\t\t\t\t\"cmdb_schema_u_crf_nas-0\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"field\": \".indexes.cmdb_index-pqduc9203h1c\",\n\t\t\t\t\t\"op\": \"=\",\n\t\t\t\t\t\"value\": item_zone\n\t\t\t\t}\n\t\t\t],\n\n\t\t\t\"selects\": [\n\n\t\t\t\t\".inode.name\",\n\t\t\t\t\"inode.id\"\n\t\t\t]\n\t\t}\n\t\tvar all_zone_count = ctx.ecu.cmdb.queryObjects(all_ql).objects\n\t\tall_zone_count.forEach(function (item2) {\n\t\t\tjg.push(item2.inode.id)\n\t\t})\n\t\tall_jg_server.push({\n\t\t\t\"jg_id\": item_zone,\n\t\t\t\"server_count\": all_zone_count.length\n\t\t})\n\t})\n\treturn (all_jg_server)\n\n}"
    }
  },
  "indexes": {
    "cmdb_index-30aeioiqyk5ux": "高级脚本",
    "cmdb_index-8p5e6iic5hsf": "cmdb_x-u1q5pengdz07",
    "cmdb_index-ibg1y94vfudg": [
      "cmdb_x-hnncm4fna4ij"
    ]
  }
}